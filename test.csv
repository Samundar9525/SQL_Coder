question,sql_query
What is the average salary in the company?,SELECT AVG(amount) FROM salary;
Who are the employees hired in 2020?,"SELECT first_name, last_name FROM employee WHERE EXTRACT(YEAR FROM hire_date) = 2020;"
List employees with more than 1 title.,SELECT emp_no FROM title GROUP BY emp_no HAVING COUNT(*) > 1;
Which department has the most employees?,SELECT dept_name FROM department d JOIN dept_emp de ON d.dept_no = de.dept_no GROUP BY dept_name ORDER BY COUNT(*) DESC LIMIT 1;
Find employees born after 1990.,"SELECT first_name, last_name FROM employee WHERE birth_date > '1990-01-01';"
List all departments.,SELECT dept_name FROM department;
Who are the department managers?,"SELECT e.first_name, e.last_name FROM employee e JOIN dept_manager dm ON e.emp_no = dm.emp_no;"
List all current job titles.,SELECT DISTINCT title FROM title WHERE to_date >= CURRENT_DATE;
Find employees with salary above 100000.,SELECT emp_no FROM salary WHERE amount > 100000;
List all usernames of logged-in employees today.,SELECT username FROM employee_login WHERE DATE(last_login) = CURRENT_DATE;
Show all employees currently active in any department.,SELECT DISTINCT emp_no FROM dept_emp WHERE to_date >= CURRENT_DATE;
How many employees have login access?,SELECT COUNT(DISTINCT emp_no) FROM employee_login;
Which employees have more than 2 titles?,SELECT emp_no FROM title GROUP BY emp_no HAVING COUNT(*) > 2;
Find the most common title in 2015.,SELECT title FROM title WHERE from_date <= '2015-12-31' AND to_date >= '2015-01-01' GROUP BY title ORDER BY COUNT(*) DESC LIMIT 1;
Get login users who logged in after 2023-01-01.,SELECT username FROM employee_login WHERE last_login > '2023-01-01';
List employees who changed departments more than once.,SELECT emp_no FROM dept_emp GROUP BY emp_no HAVING COUNT(DISTINCT dept_no) > 1;
Which employees never got promoted?,SELECT emp_no FROM title GROUP BY emp_no HAVING COUNT(DISTINCT title) = 1;
Find employees with same hire and access date.,SELECT e.emp_no FROM employee e JOIN employee_login l ON e.emp_no = l.emp_no WHERE DATE(e.hire_date) = DATE(l.created_at);
List department with highest average salary in 2023.,SELECT d.dept_name FROM department d JOIN dept_emp de ON d.dept_no = de.dept_no JOIN salary s ON de.emp_no = s.emp_no WHERE s.from_date >= '2023-01-01' GROUP BY d.dept_name ORDER BY AVG(s.amount) DESC LIMIT 1;
Find longest serving department manager.,SELECT emp_no FROM dept_manager ORDER BY (to_date - from_date) DESC LIMIT 1;
Which employees never received any salary?,SELECT e.emp_no FROM employee e LEFT JOIN salary s ON e.emp_no = s.emp_no WHERE s.emp_no IS NULL;
List employees who were promoted on the same day they joined.,SELECT e.emp_no FROM employee e JOIN title t ON e.emp_no = t.emp_no WHERE e.hire_date = t.from_date;
Find usernames of employees without department assigned.,SELECT l.username FROM employee_login l LEFT JOIN dept_emp d ON l.emp_no = d.emp_no WHERE d.emp_no IS NULL;
List departments with no current employees.,SELECT d.dept_name FROM department d LEFT JOIN dept_emp de ON d.dept_no = de.dept_no WHERE de.to_date < CURRENT_DATE;
Get employees who changed title and department on same day.,SELECT d.emp_no FROM dept_emp d JOIN title t ON d.emp_no = t.emp_no WHERE d.from_date = t.from_date;
Find the most recently hired employee.,"SELECT first_name, last_name FROM employee ORDER BY hire_date DESC LIMIT 1;"
List employees with login before hire date.,SELECT e.emp_no FROM employee e JOIN employee_login l ON e.emp_no = l.emp_no WHERE l.created_at < e.hire_date;
Find departments with more access grants than employees.,SELECT dept_no FROM manager_department_access GROUP BY dept_no HAVING COUNT(emp_no) > (SELECT COUNT(*) FROM dept_emp WHERE dept_no = manager_department_access.dept_no);
Which employees had overlapping salary and title periods?,SELECT DISTINCT t.emp_no FROM title t JOIN salary s ON t.emp_no = s.emp_no WHERE t.from_date < s.to_date AND s.from_date < t.to_date;
Get count of employees promoted in last 2 years.,SELECT COUNT(DISTINCT emp_no) FROM title WHERE from_date >= CURRENT_DATE - INTERVAL '2 years';
